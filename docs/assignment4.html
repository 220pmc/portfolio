<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Pok Man Chung" />


<title>Assignment 4</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="./assignment1a.html">Assignment 1 (Part A)</a>
</li>
<li>
  <a href="./assignment1b.html">Assignment 1 (Part B)</a>
</li>
<li>
  <a href="./assignment2.html">Assignment 2</a>
</li>
<li>
  <a href="./assignment3.html">Assignment 3</a>
</li>
<li>
  <a href="./assignment4.html">Assignment 4</a>
</li>
<li>
  <a href="./assignment5.html">Assignment 5</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Assignment 4</h1>
<h3 class="subtitle">STATS 220 Semester One 2022</h3>
<h4 class="author">Pok Man Chung</h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<div id="reasons-to-choose-the-playlist" class="section level3">
<h3>Reasons to choose the playlist</h3>
<p>Some people believe that listening to music can help them to sleep
better. To me, I do not have the habit of listening to music at bedtime.
However, listening to music for sleeping seems to be quite attractive, I
would like to give it a try.</p>
<p>Although I have little experience in picking music pieces for
sleeping, I expect that music pieces for my sleeping must be slow, calm
and happy.</p>
<p>Spotify, as one of the major music streaming platforms, provides the
ability for users to create and share their playlists. For convenience,
I randomly selected one of the playlists which specifies for sleeping. I
would like to investigate the characteristics of this playlist and
determine whether this playlist meet my expectation.</p>
<p>In the meantime, I would like to use the music pieces in this
playlist to explorer the relationships among variables.</p>
</div>
<div id="reasons-to-focus-on-certain-variables" class="section level3">
<h3>Reasons to focus on certain variables</h3>
<p>I decided to focus on <code>tempo</code>, <code>energy</code>,
<code>mode_name</code>, <code>loudness</code> and <code>year</code>. It
is because in reference to my expectation, slowness can be measured by
<code>tempo</code>, calmness can be represented by <code>energy</code>,
whereas happiness can be reflected by <code>mode_name</code>. I included
“loudness” here because I think <code>energy</code> and
<code>loudness</code> are closely related. For <code>year</code>, it
represented the release year. I would like to explorer is there any
difference in terms of calmness for music pieces in various release
year.</p>
<p>Thus, I need to investigate the following aspects:</p>
<ol style="list-style-type: decimal">
<li><p>The tempo of most of the music pieces must be slow. For
simplicity, I will classify the music pieces based on their speed
(<code>tempo</code>) into the following levels:<br />
• <code>Slow</code> if bpm &lt; 60<br />
• <code>Moderate</code> if bpm &lt; 120<br />
• <code>Fast</code> if bpm &gt;= 120</p></li>
<li><p>Most of the music pieces must be calm, which means that they must
have <code>energy</code> value &lt; 0.5.</p></li>
<li><p>Most of the music pieces must be in happy mood.</p></li>
<li><p>See if there is any association between <code>energy</code> and
<code>loudness</code>. I suspect music pieces with higher loudness will
result in higher energy. Also, music pieces in happy mood usually are in
major. I want to know can music pieces in different <code>mode</code>
affect the <code>energy</code> value.</p></li>
<li><p>See if the average energy level of Music pieces from different
years for sleeping are the same. I believe <code>year</code> and
<code>energy</code> should be independent.</p></li>
</ol>
</div>
</div>
<div id="creation-of-data-frames" class="section level2">
<h2>Creation of data frames</h2>
<pre class="r"><code>song_data &lt;- fromJSON(&quot;./Spotify_data/deep_sleep_choosen.json&quot;)

# Ensure all the songs are unique (no duplication)
nrow(song_data) == length(unique(song_data$track_id)) &amp;
  nrow(song_data) == length(unique(song_data$track_name))</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code># Round tempo to the nearest integer
song_data &lt;- mutate(song_data,
                    tempo_integer = round(tempo))

# Divide rounded tempo into 3 levels: Slow, Moderate, Fast
song_data &lt;- mutate(song_data,
                    tempo_level = case_when(tempo_integer &lt; 60 ~ &quot;Slow&quot;,
                                            tempo_integer &lt; 120 ~ &quot;Moderate&quot;,
                                            tempo_integer &gt;= 120 ~ &quot;Fast&quot;))

# Median of tempo
tempo_median &lt;- median(song_data$tempo_integer) %&gt;%
  round()

# Median of energy
energy_median &lt;- median(song_data$energy)

# Create a column for year
song_data &lt;- mutate(song_data,
                    year = substr(song_data$release_date, 1, 4))

# Summary of median energy based on release year
energy_by_year &lt;- summarise(group_by(song_data, year),
                            median_energy = median(energy))</code></pre>
</div>
<div id="types-of-chart-to-be-used" class="section level2">
<h2>Types of chart to be used</h2>
<p>For the first aspect, I have only one variable <code>tempo</code>.
Since the variable is a numeric variable, I will use histogram plot to
visualise the distribution of my data. Although density plot can also be
used, but I think histogram plot here is better as I can show the
frequency in each tempo interval. Apart from that, it will be easier for
viewers to read the plot if I divided music pieces from tempo group into
different colours.</p>
<p>For the second aspect, I also have one variable <code>energy</code>.
Similarly, I will choose histogram plot as I can show the frequency in
each interval.</p>
<p>For the third aspect, my response variable is <code>energy</code> and
my explanatory variables are <code>loudness</code> and
<code>mode_name</code>. Since both energy and loudness are numeric
variables, I decide to use scatter plot - <code>geom_point()</code> from
<code>{ggplot2}</code>. For the variable <code>mode_name</code>, since
it has 2 levels, I can further divide my scatter plot into 2 colours,
one colour for music in major and another colour for music in minor.</p>
<p>For the last aspect, the response variable is <code>energy</code>,
which is a numeric variable; the explanatory variable is
<code>year</code>, which is a categorical variable. So, I will use
jitter plot to visualise my data. Although box plot can also show the
distribution of data from different years, I think jitter plot is better
as we can see all the data points from the data set. Yet, figuring out
the median from jitter plot is harder than that of box plot. Therefore,
I also add a point in each year to indicate the median energy value.</p>
<pre class="r"><code># Distribution of tempo of song
ggplot(data = song_data) +
  
  geom_histogram(aes(x = tempo_integer,
                     colour = tempo_level,
                     fill = tempo_level),
                 lwd = 1,
                 alpha = 0.5) + 
  
  geom_vline(xintercept = tempo_median,
             lty = 2,
             lwd = 1,
             colour = &quot;blue&quot;) +
  
  geom_text(x = tempo_median + 10,
            y = 80,
            label = &quot;median&quot;,
            size = 5,
            colour = &quot;blue&quot;) +
  
  labs(title = &quot;Distribution of song tempo in the playlist&quot;,
       x = &quot;tempo (bpm)&quot;,
       caption = &quot;Figure 1&quot;) +
  
  scale_x_continuous(limit = c(40, 200),
                     breaks = seq(0, 200, 10)) +
  
  theme(panel.background = element_rect(fill = &quot;#f0f0f0&quot;,
                                        colour = &quot;#00a83e&quot;))</code></pre>
<p><img src="assignment4_files/figure-html/visualisation-2.png" width="672" /></p>
<pre class="r"><code># Distribution of song energy
ggplot(data = song_data) +
  
  geom_histogram(aes(x = energy),
                 lwd = 1,
                 colour = &quot;#f75757&quot;,
                 fill = &quot;#f75757&quot;,
                 alpha = 0.5) + 
  
  geom_vline(xintercept = energy_median,
             lty = 2,
             lwd = 1,
             colour = &quot;blue&quot;) +
  
  geom_text(x = energy_median + 0.07,
            y = 90,
            label = &quot;median&quot;,
            size = 5,
            colour = &quot;blue&quot;) +
  
  labs(title = &quot;Distribution of song energy in the playlist&quot;,
       x = &quot;energy&quot;,
       caption = &quot;Figure 2&quot;) +
  
  scale_x_continuous(limit = c(0, 1),
                     breaks = seq(0, 1, 0.05)) +
  
  theme(panel.background = element_rect(fill = &quot;#f0f0f0&quot;,
                                        colour = &quot;#00a83e&quot;))</code></pre>
<p><img src="assignment4_files/figure-html/visualisation-3.png" width="672" /></p>
<pre class="r"><code># Energy vs loudness of song in different mode_name levels
ggplot(data = song_data) + 
  
  geom_point(aes(x = loudness,
                 y = energy,
                 colour = mode_name)) + 
  
  labs(title = &quot;Plot of energy vs loudness of song&quot;,
       caption = &quot;Figure 3&quot;) + 
  
  scale_colour_manual(values = c(&quot;#6166ff&quot;, &quot;#ff0000&quot;)) +
  
  theme(panel.background = element_rect(fill = &quot;#f0f0f0&quot;,
                                        colour = &quot;#00a83e&quot;)) +
  
  transition_states(mode_name)</code></pre>
<p><img
src="assignment4_files/figure-html/visualisation-1.gif" /><!-- --></p>
<pre class="r"><code># energy by year
ggplot() + 
  
  geom_jitter(data = song_data,
              aes(x = energy,
                  y = year,
                  colour = year),
              height = 0.1) +
  
  geom_point(data = energy_by_year,
             aes(x = median_energy,
                 y = year),
             colour = &quot;blue&quot;,
             shape = 18,
             size = 5) +
  
  labs(title = &quot;Energy of music by release year&quot;,
       caption = &quot;Figure 4&quot;) +
  
  guides(colour = &quot;none&quot;)</code></pre>
<p><img src="assignment4_files/figure-html/visualisation-5.png" width="672" /></p>
</div>
<div id="steps-of-applying-the-grammar-of-graphics"
class="section level2">
<h2>Steps of applying the “grammar of graphics”</h2>
<p><code>{ggplot2}</code> provides a layered grammar of graphics
framework. Therefore, I can add different layers to the same plot.</p>
<p>For example, in the third plot, I passed my data frame
<code>song_data</code> into the base layer function so that I did not
have to passed the data frame to my geometric object layer again.</p>
<p>After that, I added a geometric object layer. Since I wanted to have
a point plot of <code>energy</code> vs <code>loudness</code>, I mapped
<code>energy</code> to <code>x</code> and <code>loudness</code> to
<code>y</code> by calling the aes() function inside the
<code>geom_point()</code> function. Inside the aes() function, I also
included the attribute <code>colour = mode_name</code> as I wanted to
divided the data into 2 subgroups, where each subgroup was shown in
different colours.</p>
<p>Then, I also added a labels layer. I included <code>title</code> and
<code>caption</code> in <code>labs()</code> to add title and assign a
figure number to the plot in order to make it easier to be
understood.</p>
<p>Also, I thought the default colours to show points from different
levels were not good enough. Thus, I added the
<code>scale_colour_manual()</code>to the plot to modify the default
colours.</p>
<p>Furthermore, I thought the default colour theme was boring.
Therefore, I added a theme layer, to change the panel background fill
and outline colours in lighter grey and green respectively.</p>
<p>Finally, I added <code>transition_state()</code> from
<code>{gganimate}</code> to create an animated plot, showing one level
in <code>mode_name</code> at a time.</p>
</div>
<div id="things-i-tried-but-didnt-work" class="section level2">
<h2>Things I tried but didn’t work</h2>
<p>There are 2 things that I tried but did not work.</p>
<p>Initially, I decided to go for playlist with more than 3000 songs so
that my data size is bigger. However, I could not obtain the json files
as the app dedicated to this assignment went timeout. Therefore, I
decided to go for a shorter playlist with 267 pieces.</p>
<p>Besides, by using the <code>geom_text()</code> function, I can add
annotation to the plot. However, the outline of the words is not sharp
and there are some unwanted shadows around the words. I tried to change
the text into different colour but I could not get rid of the blurry
shadows.</p>
</div>
<div id="overall-conclusion" class="section level2">
<h2>Overall Conclusion</h2>
<div id="aspect-1" class="section level3">
<h3>Aspect 1</h3>
<p>From Figure 1, we can 2 clusters from the plot and the data is
bimodal, with one mountain sitting at 75 bpm and another mountain
sitting at 140 bpm. The median tempo is approximately 75 bpm. And most
importantly, there is only a few music pieces belong to the slow group.
So, in terms of slowness, this playlist does not meet my
expectation.</p>
</div>
<div id="aspect-2" class="section level3">
<h3>Aspect 2</h3>
<p>From Figure 2, we can see that the energy level for most of the music
pieces are less than 0.2 and the data is highly right skewed. The median
energy of music pieces in this playlist is approximately 0.03.
Therefore, in terms of energy, this playlist does far better than my
exception.</p>
</div>
<div id="aspect-3-4" class="section level3">
<h3>Aspect 3 &amp; 4</h3>
<p>There are multiple useful pieces of information that can be studied
from Figure 3.</p>
<p>Firstly, there are considerably amount of music pieces in minor when
compared to pieces in major. Although the number of minor music pieces
is less than that of major music pieces, I still believe that these
minor music pieces will affect the overall listening experience during
my bedtime since I really expect a playlist that can bring me lots of
happiness.</p>
<p>Secondly, we can see that the higher the loudness, the higher the
energy of the music piece is. However, we can observe curvature in the
plot, which suggests that the trend is not linear. Besides, the
variability is higher for higher loudness.</p>
<p>Thirdly, it seems that energy level does not depend on the mode of
music pieces as illustrated by this animated plot. Therefore, mode may
not be a factor that can affect <code>energy</code> value in this
playlist.</p>
</div>
<div id="aspect-5" class="section level3">
<h3>Aspect 5</h3>
<p>From Figure 4, we can see that the median level of energy is
decreasing from 2019 to 2022. However, from the jitter plot, we know
that year 2019 has only 2 data points. The number of music pieces from
2020 and 2022 are similar, but are both less than that from 2021.
Besides, the difference in median energy level between 2020, 2021 and
2022 are quite small. Therefore, it is difficult to state music are
becoming calmer over the years.</p>
</div>
<div id="final-conclusion" class="section level3">
<h3>Final Conclusion</h3>
<p>After investigate some variables of this playlist, I am not going to
take this playlist. It is because I think the overall tempo is too fast
and could make me awake throughout the night. Also, despite the fact
that the overall energy is quite low, which implies that music pieces
are calm on average, I do not hope to listen to too many minor
pieces.</p>
<p>Also, we can spot that there is positive non-linear association
between loudness and energy. The higher the loudness, the higher the
energy.</p>
</div>
<div id="last-update" class="section level3">
<h3>Last Update</h3>
<p>16/05/2022</p>
</div>
</div>
<div id="back-to-home-page" class="section level2">
<h2>Back to Home Page</h2>
<p><a href="https://220pmc.github.io/portfolio/">Back</a></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
